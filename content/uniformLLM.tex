\section{一致大数定律}

1. 示性函数记号的问题
2. Talagrand不等式
3. 假设类的引入(0-下水平集...
 
设$\{X_i\}_{i=1}^n$是来自分布函数$F$的独立同分布样本, $F$经典的无偏估计是经验分布函数
\begin{equation*}
	\hat F_n(t) 
	:= \frac{1}{n} \sum_{i=1}^n \I{(-\infty, t]}(X_i). 
\end{equation*}
经典的\textbf{Glivenko-Cantelli定理}告诉我们, 经验分布函数$\hat F_n$是$F$在一致范数下的强相合估计, 即$\hat F_n$和$F$之间的\textbf{Kolmogorov距离}几乎处处收敛到$0$: 
\begin{equation*}
	\|\hat F_n - F\|_{\infty} 
	:= \sup_{t \in \mathbb{R}} |\hat F_n(t) - F(t)| \stackrel{a.s.}{\to} 0
\end{equation*}

%在统计背景下,  将$\hat F_n$代入$F$的泛函$\gamma(F)$可以得到估计$\gamma(\hat F_n)$, 例如
%\begin{example}
%	给定可积函数$g$, 定义期望泛函$\gamma_g(F) := \int g \dd F$, 代入估计$\hat F_n$
%	\begin{equation*}
%		\gamma_g(\hat F_n) = \frac{1}{n} \sum_{n=1}^n g(X_i)
%	\end{equation*}
%	可以作为$\mathbb{E} g(X)$的估计. 
%\end{example}
%
%若泛函$\gamma$连续, 估计$\gamma(\hat F_n)$的相合性可以很好地被研究: 称泛函$\gamma$在$F$关于极大范数$\| \cdot \|_{\infty}$是\textbf{连续的}, 如果对于任意$\epsilon > 0$, 存在$\delta > 0$, 使得对任意$\|G - F\|_{\infty} < \delta$的函数$G$, 总有$|\gamma(G) - \gamma(F)| < \epsilon$. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{经验过程}

设$\{X_i\}_{i=1}^n$是来自分布$\mathbb{P}$的$n$个独立同分布样本, \textbf{经验分布}为$\mathbb{P}_n(A) := \frac{1}{n} \sum_{i=1}^n \I{A}(X_i)$, 其中集合$A \subseteq \mathcal{X}$. 
考虑区域$\cX$上的$\mathbb{P}$-可积实值函数类$\mathscr{F}$, 函数$f \in \mathscr{F}$关于初始测度$\mathbb{P}$和经验测度$\mathbb{P}_n$的积分分别为 
\begin{equation*}
	\mathbb{P}(f) = \int f \dd \mathbb{P} = \E_{X \sim \mathbb{P}} [f(X)], \quad
	\mathbb{P}_n(f) = \frac{1}{n} \sum_{i=1}^n f(X_i). 
\end{equation*}
于是经验过程$X_f = \mathbb{P}(f) - \mathbb{P}_n(f)$, $f \in \mathscr{F}$衡量了经验期望和总体期望的偏差. 
经验过程理论的研究对象是$\mathbb{P}$在函数类$\mathscr{F}$上被$\mathbb{P}_n$一致逼近的性质, 更为具体的, 研究随机量 
\begin{equation*}
	\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} 
	:= \sup_{f \in\mathscr{F}} \left| \mathbb{P}_n(f) - \mathbb{P}(f) \right|
	= \sup_{f \in\mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n f(X_i) - \mathbb{E}[f(X)] \right|
\end{equation*}
的测度集中现象和随机过程$\{(\mathbb{P} - \mathbb{P}_n)(f) \colon f \in \mathscr{F}\}$的概率极限理论. 

第一个问题涉及 $| P_n - P |_F$ 在 $F$ 一致有界的情况下围绕其均值的集中性。问题的关键在于：变量 $| P_n - P |_F$ 在其均值附近有多集中？是否可以得到关于差值 $| P_n - P |_F - \mathbb{E} | P_n - P |F$ 的指数不等式，且达到与经典不等式对 $\sum{i=1}^n \xi_i$（其中 $\xi_i$ 是中心化且有界的）同样的精度？还是需要为我们同时考虑无穷多个独立随机变量之和而付出额外的代价？

对此问题的令人惊讶的答案是：在适当定义参数（规模和方差）的情况下，经典的指数不等式在经验过程上依然成立。这是经验过程理论中最重要、最强大的结果之一，称为 Talagrand 不等式。在本节稍后部分，我们将回顾实随机变量的经典指数不等式，为后续的经验过程部分提供背景。

可测函数类的上确界未必可测, 恐有不测之忧

\begin{itemize}
	\item 如果$\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \stackrel{\mathbb{P}}{\to} 0$, 则称函数类$\mathscr{F}$为分布$\mathbb{P}$上的一个\textbf{Glivenko-Cantelli类}, 或者$\mathscr{F}$满足\textbf{Glivenko-Cantelli律}; 
	\item 如果$\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \stackrel{a.s.}{\to} 0$, 则称函数类$\mathscr{F}$满足\textbf{强Glivenko-Cantelli律}. 
\end{itemize}
经典的Glivenko-Cantelli定理实际上是在示性函数类$\mathscr{F} = \{\I{(- \infty, t]} \colon t \in \mathbb{R} \}$上的强一致定律. 
对更为广义的函数类的研究则始于Vapnik-Čhervonenkis(1971)和Dudley(1978)的工作, 这在统计中有着十分重要的作用. 

量$\E\left[\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}\right]$实际上是经验测度$\mathbb{P}_n$和$\mathbb{P}$之间的Wasserstein距离$W(\mathbb{P}, \mathbb{P}_n)$. 

 
\begin{example}[M估计?\cite{nickl:2015a} P110]
若分布$\mathbb{P}_{\theta^*}$中的$\theta^* \in \Theta$未知, 其中空间$\Theta$可能是$\mathbb{R}^d$, 对应参数估计问题; 或者是某个函数类$\mathscr{G}$, 对应非参数问题. 

$\theta^*$的估计总是基于最小化损失函数$\mathcal{L}_{\theta} (X)$: 最优的$\theta$应当使得总体风险$R(\theta, \theta^*) := \mathbb{E}_{\mathbb{P}_{\theta^*}}[\mathcal{L}_{\theta} (X)]$达到最小. 
然而在实践中, 我们通常无法获得总体数据, 只能根据有限个样本$\{ X_i \}_{i=1}^n$, 在$\Theta$的某个子集$\Theta_0$上最小化经验风险得到估计
\begin{equation*}
	\hat \theta 
	= \argmin_{\theta \in \Theta_0} \hat R_n (\theta, \theta^*) 
	= \argmin_{\theta \in \Theta_0} \frac{1}{n} \sum_{i=1}^n \mathcal{L}_{\theta} (X_i). 
\end{equation*}
我们希望经验风险和总体风险足够接近, 即控制过度风险$\mathbb{E}(\hat \theta, \theta^*) := R(\hat \theta, \theta^*) - \inf_{\theta \in \Theta_0} R(\theta, \theta^*)$. 

为了方便起见, 我们假设存在某个$\theta_0 \in \Theta_0$满足$R(\theta_0, \theta^*) = \inf_{\theta \in \Theta_0}R(\theta, \theta^*)$. 
于是过度风险可以做如下估计
\begin{equation*}
	\mathbb{E}(\hat \theta, \theta^*)
	= \underbrace{\left[ R(\hat \theta, \theta^*) - \hat R_n(\hat \theta, \theta^*) \right]}_{T_1}
	+ \underbrace{\left[ \hat R_n(\hat \theta, \theta^*) - \hat R_n(\theta_0, \theta^*) \right]}_{T_2}
	+ \underbrace{\left[ \hat R_n(\theta_0, \theta^*) - R(\theta_0, \theta^*) \right]}_{T_3}. 
\end{equation*}
其中$|T_1| = \left| \frac{1}{n} \sum_i \mathcal{L}_{\theta} (X_i) - \mathbb{E}_{\mathbb{P}_{\theta^*}}[\mathcal{L}_{\theta} (X)] \right| \leq \|\mathbb{P}_n - \mathbb{P}\|_{\mathcal{L}_{\Theta_0}}$, 这需要需要考虑损失函数类$\mathcal{L}_{\Theta_0} := \{ \mathcal{L}_{\theta}(\cdot) \colon \theta \in \Theta_0 \}$的一致大数定律; 
而$\hat \theta$最小化了经验风险, 可以看到$T_2 \leq 0$; 
$T_3$对应的则是控制随机变量$\frac{1}{n} \sum_i \mathcal{L}_{\theta_0}(X_i)$及其期望$\mathbb{E}_{\mathbb{P}_{\theta_0}}[\mathcal{L}_{\theta} (X)]$之间的偏差, 这里$\theta_0$是一个未知但非随机的值, 因此可以用测度集中的方法来得到. 
当然$\|\mathbb{P}_n - \mathbb{P}\|_{\mathcal{L}_{\Theta_0}}$也是$T_3$的上界, 于是过度风险至多是$2 \|\mathbb{P}_n - \mathbb{P}\|_{\mathcal{L}_{\Theta_0}}$. 
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{经验过程的尾部概率界}

设$(X_1, \dots, X_n)$来自乘积分布$\mathbb{P} = \otimes_{i=1}^n \mathbb{P}_i$, 其中$\mathbb{P}_i$的支撑集$\mathcal{X}_i \subseteq \mathcal{X}$. 
对于定义域为$\mathcal{X}$函数类$\mathscr{F}$, 考虑随机变量
\begin{equation*}
	Z := \sup_{f \in \mathscr{F}} \left\{ \frac{1}{n} \sum_{i=1}^n f(X_i) \right\}. 
\end{equation*}
注意这里的$\sup$是对每一点$\bm{X} \in \mathcal{X}^n$取极大值. 
若要考虑$\sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_i f(X_i) \right|$, 只需考虑在函数类$\tilde{\mathscr{F}} := \mathscr{F} \cup (- \mathscr{F})$上考虑上确界即可: 
\begin{equation*}
	\sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n f(X_i) \right|
	= \sup_{f \in \mathscr{F}} \left\{ \max \left\{ \frac{1}{n} \sum_{i=1}^n f(X_i), - \frac{1}{n} \sum_{i=1}^n f(X_i) \right\} \right\} 
	= \sup_{\tilde{\mathscr{F}}} \left\{ \frac{1}{n} \sum_{i=1}^n f(X_i) \right\}
\end{equation*}

我们把Hoeffding

\begin{theorem}[泛函Hoeffding不等式]
	若对每个$f \in \mathscr{F}$, 都有$f(\mathcal{X}_i) \subseteq  [a_{i, f}, b_{i, f}]$, $i = 1, \dots, n$,  那么对任意$\delta \geq 0$, 成立
	\begin{equation}
		\mathbb{P}[ Z \geq \mathbb{E}[Z] + \delta] 
		\leq \exp \left( - \frac{n \delta^2}{4 L^2} \right), 
	\end{equation}
	其中$L^2 = \sup_{f \in \mathscr{F}} \left\{ \frac{1}{n} \sum_i (b_{i, f} - a_{i, f})^2 \right\}$. 
\end{theorem}

\begin{proof}
	为了简便, 我们使用非重尺度化的$Z = \sup_{f \in \mathscr{F}} \left\{ \sum_i f(X_i) \right\}$, 它是$\bm{X} = (X_1, \dots, X_n)$的泛函.  
	
	定义$Z_j \colon x_j \mapsto Z(X_1, \dots, X_{j-1}, x_j, X_{j+1}, \dots, X_n)$
	
	对于$\lambda > 0$, 由引理\ref{lemma:EntropyTensorization}、 \ref{lemma:EntropyBoundForUnivariateFunctions}, 
	
	对$f \in \mathscr{F}$, 定义$\cA(f) := \left\{ (x_1, \dots, x_n) \colon Z = \sum_i f(x_i) \right\}$
\end{proof}


\begin{theorem}[经验过程的Talagrand集中度]
	若可数函数类$\mathscr{F}$是$b$一致有界的, 那么对任意$\delta > 0$, 成立
	\begin{equation*}
		\mathbb{P}[ Z \geq \mathbb{E}[Z] + \delta] 
		\geq 2 \exp \left( - \frac{n \delta^2}{8 e \mathbb{E} \Sigma^2 + 4 b \delta} \right), 
	\end{equation*}
	其中$\Sigma^2 = \sup_{f \in \mathscr{F}} \frac1n f^2(X_i)$. 
\end{theorem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{函数类的Rademacher复杂度}

Peter L.Bartlett 与Shahar Mendelson （此人是Empirical Process的专家） 提出了用Rademacher / Gaussian Complexity 来研究 Risk Bounds 的方法


一致大数定律的的一个重要度量是函数类$\mathscr{F}$的\textbf{Rademacher复杂度}. 
设$\mathscr{F}$为区域$\mathcal{X}$上的函数类, 对于点集$\bm{x}_1^n \in \mathcal{X}^n$, 记$\mathscr{F}(\bm{x}_1^n) := \{(f(x_1), \dots, f(x_n)) \colon f \in \mathscr{F}\}$. 
$\mathscr{F}$关于点集$\bm{x}_1^n$的Rademacher复杂度为
\begin{equation*}
	\mathcal{R}_n(\mathscr{F}) 
	:= \mathbb{E}_{\bm{\epsilon}} \left[ \sup_{\bm{a} \in \mathscr{F}(\bm{x}_1^n)} \langle f(\bm{x}_1^n), \bm{\epsilon} \rangle  \right]
	= \mathbb{E}_{\bm{\epsilon}} \left[ \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i f(x_i) \right| \right]. 
\end{equation*}
进一步地, 函数类$\mathscr{F}$关于经验分布$\mathbb{P}_n$的Rademacher复杂度为
\begin{equation*}
	\mathcal{R}_{\mathbb{P}_n}(\mathscr{F})
	:= \mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[ \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{k=1}^n \epsilon_i f(X_i) \right| \right]. 
\end{equation*}
这可以看作随机向量$(f(X_1), \cdots, f(X_n))_{f \in \mathscr{F}}$和噪声向量$\bm{\epsilon}$之间最大相关关系的平均值. 



对于一致有界函数类$\mathscr{F}$, 我们将看到“$\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \approx \mathcal{R}_{\mathbb{P}_n}(\mathscr{F})$”, 而Rademacher复杂度的界是更为容易得到的. 

\begin{lemma}
	若函数类$\mathscr{F}$是$b$-一致有界	的, 那么随机变量$\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}$是$\frac{b}{\sqrt{n}}$-次高斯的. 
\end{lemma}
\begin{proof}
	引入函数的中心化记号$\bar f(x) := f(x) - \mathbb{E}[f(X)]$, 则$\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}$可以简记为$\sup_{f \in \mathscr{F}} |\frac{1}{n} \sum_i \bar f(X_i)|$. 
	考虑函数$G(x_1, \dots, x_n) = \sup_{f \in \mathscr{F}} |\frac{1}{n} \sum_i \bar f(x_i)|$, 它与各坐标的顺序置换无关. 
	于是只需对第一个坐标分量进行扰动, 就可以说明它满足参数为$(\frac{2b}{n}, \dots, \frac{2b}{n})$的有界差不等式: 
	设向量$\bm{X} = (x_1, \dots, x_n)$, $\bm{Y} = (y_1, \dots, y_n)$满足$x_i = y_i$, $i > 1$, 说明$|G(\bm{X}) - G(\bm{Y})| < \frac{2b}{n}$即可. 
	对任意$f \in \mathscr{F}$, 由于$\|f\|_{\infty} \leq b$, 
	\begin{align*}
		\left|\frac{1}{n} \sum_{i=1}^n \bar f(x_i)\right| - \sup_{h \in \mathscr{F}} \left|\frac{1}{n} \sum_{i=1}^n \bar h(y_i)\right|
		\leq \left|\frac{1}{n} \sum_{i=1}^n \bar f(x_i)\right| - \left|\frac{1}{n} \sum_{i=1}^n \bar f(y_i)\right|
		\leq \frac{1}{n} |\bar f(x_1) - \bar f(y_1)| 
		\leq \frac{2b}{n}. 
	\end{align*}
	结合推论\ref{cor:BddDiffIneq}, 可以看到$\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}$是$\frac{b}{\sqrt{n}}$-次高斯的. 
\end{proof}

\begin{theorem}\label{thm:EmpericalMeasureErrorUpperBddByRC}
	设函数类$\mathscr{F}$是$b$-一致有界	的, 对任意$n \in \Z_+$, $\delta \geq 0$, 我们有
	\begin{equation*}
		\mathbb{P} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \leq 2 \mathcal{R}_{\mathbb{P}_n}(\mathscr{F}) + \delta \right]
		\geq 1 - \exp \left(- \frac{n \delta^2}{2 b^2} \right). 
	\end{equation*}
	于是如果函数类$\mathscr{F}$满足$\mathcal{R}_{\mathbb{P}_n}(\mathscr{F}) = o(1)$, 就可以得到$\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}$以指数速度几乎确定收敛到$0$, 即$\mathscr{F}$为$\mathbb{P}$上的Glivenko-Cantelli类. 
\end{theorem}

在证明之前, 我们给出一个函数类上确界期望的不等式, 它和Fatou不等式或者Jensen不等式类似:
对于可积函数类$\mathscr{G}$, 有$\mathbb{E} [g(X)] \leq \mathbb{E}\left[ \sup_{g \in \mathscr{G}} |g(X)| \right]$, 于是再对左侧取上确界可以得到
\begin{equation}\label{eq:SupIneq}
	\sup_{g \in \mathscr{G}} \mathbb{E} [g(X)] 
	\leq  \mathbb{E}\left[ \sup_{g \in \mathscr{G}} |g(X)| \right]. 
\end{equation}
进一步地, 对于凸的非减函数$\Phi$, 结合Jensen不等式, 我们有
\begin{equation}\label{eq:SupJensenIneq}
	\sup_{g \in \mathscr{G}} \Phi(\mathbb{E} [|g(X)|])
	\leq \Phi \left( \mathbb{E} \left[ \sup_{g \in \mathscr{G}} |g(X)| \right] \right)
	\leq \mathbb{E} \left[ \Phi \left( \sup_{g \in \mathscr{G}} |g(X)| \right) \right]
\end{equation}

\begin{proof}
	我们首先证明$2 \mathcal{R}_{\mathbb{P}_n}(\mathscr{F})$是$\mathbb{E} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \right]$的上界, 这可以使用\textbf{对称化技巧}来得到: 
	设$\bm{Y} = (Y_1, \dots, Y_n)$与$\bm{X}$独立同分布, $\bm{\epsilon} = (\epsilon_1, \dots, \epsilon_n)$为独立的Rademacher向量, 于是$\epsilon_i (f(X_i) - f(Y_i))$和$f(X_i) - f(Y_i)$有相同的分布: 
	\begin{align*}
		&\mathbb{P}[f(X_i) - f(Y_i) \leq t] 
		= \frac{1}{2} \mathbb{P}[f(X_i) - f(Y_i) \leq t] + \frac{1}{2} \mathbb{P}[f(Y_i) - f(X_i) \leq t] \\
		=& \mathbb{P}[\epsilon_i = 1] \cdot \mathbb{P}[\epsilon_i(f(X_i) - f(Y_i)) \leq t | \epsilon_i = 1] + \mathbb{P}[\epsilon_i = -1] \cdot  \mathbb{P}[\epsilon_i(f(X_i) - f(Y_i)) \leq t | \epsilon_i = -1] \\
		=& \mathbb{P}[\epsilon_i (f(X_i) - f(Y_i)) \leq t]. 
	\end{align*} 
	结合不等式\eqref{eq:SupIneq}、三角不等式
	\begin{align*}
		& \mathbb{E} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \right]
		= \mathbb{E}_{\bm{X}} \left[ \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i = 1}^n f(X_i) - \mathbb{E}_{Y_1} [f(Y_1)] \right| \right]\\
		= & \mathbb{E}_{\bm{X}} \left[ \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \left( f(X_i) - \mathbb{E}_{Y_i} [f(Y_i)] \right) \right| \right] 
		= \mathbb{E}_{\bm{X}} \left[ \sup_{f \in \mathscr{F}} \left| \mathbb{E}_{\bm{Y}} \left[ \frac{1}{n} \sum_{i=1}^n \left( f(X_i) - f(Y_i) \right) \right] \right| \right] \\
		\leq & \mathbb{E}_{\bm{X}, \bm{Y}} \left[ \sup_{f \in \mathscr{F}} \left|  \frac{1}{n} \sum_{i=1}^n \left( f(X_i) - f(Y_i) \right) \right| \right]
		=  \mathbb{E}_{\bm{X}, \bm{Y}, \bm{\epsilon}} \left[ \sup_{f \in \mathscr{F}} \left|  \frac{1}{n} \sum_{i=1}^n \epsilon_i \left( f(X_i) - f(Y_i) \right) \right| \right] \\
		\leq & \mathbb{E}_{\bm{X}, \bm{\epsilon}}  \left[ \sup_{f \in \mathscr{F}} \left|  \frac{1}{n} \sum_{i=1}^n \epsilon_i f(X_i) \right| \right] + \mathbb{E}_{\bm{Y}, \bm{\epsilon}}  \left[ \sup_{f \in \mathscr{F}} \left|  \frac{1}{n} \sum_{i=1}^n \epsilon_i f(Y_i) \right| \right]
		= 2 \mathcal{R}_{\mathbb{P}_n}(\mathscr{F}). 
	\end{align*}
	于是根据$\frac{b}{\sqrt{n}}$-次高斯随机变量$\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}$的上偏差不等式, 对任意$\delta \geq 0$, 我们有
	\begin{equation*}
		\mathbb{P} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \leq 2 \mathcal{R}_{\mathbb{P}_n}(\mathscr{F}) + \delta \right]
		\geq  \mathbb{P} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \leq \mathbb{E} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \right] + \delta \right] 
		\geq 1 - \exp\left( - \frac{n t^2}{2 b^2} \right). 
	\end{equation*}
\end{proof}

对称化技巧实际上考虑了随机变量$\|\mathbb{S}_n\|_{\mathscr{F}} := \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_i \epsilon_i f(X_i) \right|$——它的期望就是Rademacher复杂度, 我们有更强的结论. 
\begin{proposition}
	对于任意非减的凸函数$\Phi \colon \mathbb{R} \to \mathbb{R}$, 我们有
	\begin{equation*}
		\mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[ \Phi\left(\frac{1}{2} \|\mathbb{S}\|_{\bar{\mathscr{F}}} \right)\right]
		\leq \mathbb{E}_{\bm{X}} \left[ \Phi\left(\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}\right)\right]
		\leq \mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[ \Phi\left(2 \|\mathbb{S}\|_{\mathscr{F}} \right)\right]
	\end{equation*}	
\end{proposition}
\begin{remark}
	特别地, 取$\Phi(t) = t$可以得到
	\begin{equation}\label{eq:SandwichedByRC}
		\frac{1}{2} \mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[\|\mathbb{S}\|_{\bar{\mathscr{F}}}\right] 
		\leq \mathbb{E}_{\bm{X}} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \right] 
		\leq 2 \mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[ \|\mathbb{S}\|_{\mathscr{F}} \right] 
	\end{equation}
\end{remark}
\begin{proof}
	右侧不等式可以看作是上一定理的证明的简单推广: 结合不等式\eqref{eq:SupJensenIneq}、三角不等式, 利用$\Phi$的凸性, 我们有
	\begin{align*}
		& \mathbb{E}_{\bm{X}} \left[ \Phi\left(\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}\right)\right]
		= \mathbb{E}_{\bm{X}} \left[ \Phi\left( \sup_{f \in \mathscr{F}} \left| \mathbb{E}_{\bm{Y}} \left[ \frac{1}{n} \sum_{i=1}^n \left( f(X_i) - f(Y_i) \right) \right] \right| \right)\right] \\
		\leq & \mathbb{E}_{\bm{X}, \bm{Y}} \left[ \Phi\left( \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \left( f(X_i) - f(Y_i) \right)  \right| \right)\right]
		= \mathbb{E}_{\bm{X}, \bm{Y}, \bm{\epsilon}} \left[ \Phi\left( \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i \left( f(X_i) - f(Y_i) \right)  \right| \right)\right] \\
		\leq & \mathbb{E}_{\bm{X}, \bm{Y}, \bm{\epsilon}} \left[ \Phi\left( \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i f(X_i) \right| + \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i f(Y_i) \right| \right)\right] \\
		\leq & \frac{1}{2} \mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[ \Phi\left( 2 \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i f(X_i) \right| \right)\right] + \frac{1}{2} \mathbb{E}_{\bm{Y}, \bm{\epsilon}} \left[ \Phi\left( 2 \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i f(Y_i) \right| \right)\right] \\
		= & \mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[ \Phi\left( 2 \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i f(X_i) \right| \right)\right]
		= \mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[ \Phi\left(2 \|\mathbb{S}\|_{\mathscr{F}} \right)\right].  
	\end{align*}
	下面我们证明左侧不等式, 由不等式\eqref{eq:SupJensenIneq}、三角不等式和$\Phi$的非减性、$\Phi$的凸性, 我们有
	\begin{align*}
		& \mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[ \Phi\left(\frac{1}{2} \|\mathbb{S}\|_{\bar{\mathscr{F}}} \right)\right]
		= \mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[ \Phi\left(\frac{1}{2} \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i \left( f(X_i) - \mathbb{E}_{Y_i}[f(Y_i)] \right)  \right| \right)\right] \\
		\leq & \mathbb{E}_{\bm{X}, \bm{Y}, \bm{\epsilon}} \left[ \Phi\left(\frac{1}{2} \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i \left( f(X_i) - f(Y_i) \right)  \right| \right)\right] 
		= \mathbb{E}_{\bm{X}, \bm{Y}} \left[ \Phi\left(\frac{1}{2} \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \left( f(X_i) - f(Y_i) \right)  \right| \right)\right] \\
		\leq & \mathbb{E}_{\bm{X}, \bm{Y}} \left[ \Phi\left(\frac{1}{2} \left\{ \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \left( f(X_i) - \mathbb{E}_{\mathbb{P}}[f] \right) + \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \left( f(Y_i) - \mathbb{E}_{\mathbb{P}}[f] \right)  \right|  \right\} \right| \right)\right] \\
		\leq & \frac{1}{2} \mathbb{E}_{\bm{X}} \left[ \Phi\left( \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \left( f(X_i) - \mathbb{E}_{\mathbb{P}}[f] \right) \right| \right)\right] + \frac{1}{2} \mathbb{E}_{\bm{Y}} \left[ \Phi\left( \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \left( f(Y_i) - \mathbb{E}_{\mathbb{P}}[f] \right) \right| \right)\right] \\
		= & \mathbb{E}_{\bm{X}} \left[ \Phi\left(\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}\right)\right]. 
	\end{align*}
\end{proof}


\begin{proposition}\label{thm:EmpericalMeasureErrorLowerBddByRC}
	设函数类$\mathscr{F}$是$b$-一致有界	的, 对任意$n \in \Z_+$, $\delta \geq 0$, 我们有
	\begin{equation*}
		\mathbb{P} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \geq \frac{1}{2} \mathcal{R}_{\mathbb{P}_n}(\mathscr{F}) - \frac{\sup_{f \in \mathscr{F}}\left|\mathbb{E}_{\mathbb{P}}[f]\right|}{2 \sqrt{n}} - \delta \right]
		\geq 1 - \exp \left(- \frac{n \delta^2}{2 b^2} \right). 
	\end{equation*}
	于是当函数类$\mathscr{F}$的Rademacher复杂度$\mathcal{R}_{\mathbb{P}_n}(\mathscr{F})$存在远离$0$的下界时, $\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}$不可能以概率收敛于零, 即$\mathscr{F}$不可能为$\mathbb{P}$上的Glivenko-Cantelli类.
\end{proposition}
\begin{proof}
	根据三角不等式容易得到估计
	\begin{equation*}
		\|\mathbb{S}_n\|_{\bar{\mathscr{F}}}
		= \sup_{f \in \mathscr{F}} \left|\frac{1}{n} \sum_{i=1}^n \epsilon_i f(X_i) - \frac{1}{n} \sum_{i=1}^n \epsilon_i \mathbb{E}_{\mathbb{P}}[f] \right|
		\geq \sup_{f \in \mathscr{F}} \left|\frac{1}{n} \sum_{i=1}^n \epsilon_i f(X_i)\right| - \sup_{f \in \mathscr{F}} \left|\mathbb{E}_{\mathbb{P}}[f]\right| \cdot \frac{\left| \sum_{i=1}^n \epsilon_i \right|}{n}.
	\end{equation*}
	再由Cauchy–Schwarz不等式可得$\displaystyle \mathbb{E}\left[\left| \sum_{i=1}^n \epsilon_i \right|\right] \leq \sqrt{\mathbb{E}\left[ \left(\sum_{i=1}^n \epsilon_i\right)^2 \right]} = \sqrt{\mathbb{E}\left[ \sum_{i=1}^n \epsilon_i^2 \right]} = \sqrt{n}$. 
	于是由不等式\eqref{eq:SandwichedByRC}, $\frac{b}{\sqrt{n}}$-次高斯随机变量$\|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}}$的下偏差不等式, 可见
	\begin{align*}
		& 1 - \exp \left(- \frac{n \delta^2}{2 b^2} \right) 
		\leq \mathbb{P} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \geq \mathbb{E} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \right] - \delta \right] \\
		\leq & \mathbb{P} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \geq \frac{1}{2} \mathbb{E}_{\bm{X}, \bm{\epsilon}} \left[\|\mathbb{S}\|_{\bar{\mathscr{F}}}\right] - \delta \right]
		\leq  \mathbb{P} \left[ \|\mathbb{P}_n - \mathbb{P}\|_{\mathscr{F}} \geq \frac{1}{2} \mathcal{R}_{\mathbb{P}_n}(\mathscr{F}) - \frac{\sup_{f \in \mathscr{F}}\left|\mathbb{E}_{\mathbb{P}}[f]\right|}{2 \sqrt{n}} - \delta \right]
	\end{align*}
\end{proof}

于是Rademacher复杂度是$1$的高阶无穷小为满足Glivenko-Cantelli性质提供了一个充分必要条件. 
下面两节我们寻求控制Rademacher复杂度的方法. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{多项式识别函数类}

\begin{definition}[多项式识别]
	称区域$\mathcal{X}$上的函数类$\mathscr{F}$有阶为$\nu \geq 1$的多项式识别, 如果对任意正整数$n$和点集$\bm{x}_1^n = \{x_1, \dots, x_n\} \subseteq \mathcal{X}$, 集合
	\begin{equation*}
		\mathscr{F}(\bm{x}_1^n) 
		:= \{(f(x_1), \dots, f(x_n)) \colon f \in \mathscr{F}\}
		\subseteq \mathbb{R}^n
	\end{equation*}
	的基数$\card(\mathscr{F}(\bm{x}_1^n)) \leq (n+1)^{\nu}$. 
\end{definition}

很多时候函数类的基数$\card(\mathscr{F}) = \infty$, 但是

\begin{lemma}\label{lemma:RCOfPolynomialDiscriminationFunClass}
	若区域$\mathcal{X}$上的函数类$\mathscr{F}$有阶为$\nu \geq 1$的多项式识别, 那么对任意正整数$n$, 函数类$\mathscr{F}$关于点集$\bm{x}_1^n = \{x_1, \dots, x_n\} \subseteq \mathcal{X}$的Rademacher复杂度
	\begin{equation*}
		\mathcal{R}_n(\mathscr{F})
		= \mathbb{E}_{\bm{\epsilon}} \left[ \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i f(x_i) \right| \right]
		\leq 2 D(\bm{x}_1^n) \sqrt{\frac{\nu \log(n+1)}{n}}, 
	\end{equation*}
	其中$D(\bm{x}_1^n) = \sup_{f \in \mathscr{F}} \sqrt{\frac{1}{n} \sum_i f(x_i)^2}$为向量集合$\mathscr{F}(\bm{x}_1^n) / \sqrt{n}$的$\ell^2$半径. 
\end{lemma}
\begin{proof}
	考虑集合$A = \left\{ \frac{1}{n} (f(x_1), \dots, f(x_n)) \colon f \in \mathscr{F} \cup (-\mathscr{F}) \right\} \subseteq \mathbb{R}^n$, 由于$\mathscr{F}$有阶为$\nu$的多项式识别, 我们有$\card(A) \leq 2 (n+1)^{\nu}$. 
	回忆示例\ref{ex:RCofPtSet}, 不等式左侧等价于点集$A$的Rademacher复杂度, 即
	\begin{equation*}
		\mathcal{R}(A) 
		= \mathbb{E}_{\bm{\epsilon}}\left[ \sup_{\bm{a} \in A} \langle \bm{a}, \bm{\epsilon} \rangle \right]
		= \mathbb{E}_{\bm{\epsilon}}\left[ \max_{\bm{a} \in A} \langle \bm{a}, \bm{\epsilon} \rangle \right], 
	\end{equation*}
	其中$\langle \bm{a}, \bm{\epsilon} \rangle$总是$D(\bm{x}_1^n) / \sqrt{n}$-次高斯的, 于是由定理\ref{thm:UpperBdForMaximaOfSGRV}
	\begin{align*}
		\mathbb{E}_{\bm{\epsilon}}\left[ \max_{\bm{a} \in A} \langle \bm{a}, \bm{\epsilon} \rangle \right] 
		\leq D(\bm{x}_1^n) / \sqrt{n} \cdot \sqrt{2 \log(\card(A))}
		\leq 2 D(\bm{x}_1^n) \sqrt{\frac{\nu \log(n+1)}{n}}. 
	\end{align*}
\end{proof}
\begin{remark}
	若函数类$\mathscr{F}$是$b$-一致有界的, 那么它关于经验分布$\mathbb{P}_n$的Rademacher复杂度
	\begin{align*}
		& \mathcal{R}_{\mathbb{P}_n}(\mathscr{F})
		= \E_{\bm{X}} \left[ \mathbb{E}_{\bm{\epsilon}} \left[ \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i f(X_i) \right| \right] \right]
		= \E_{\bm{X}} \left[ \mathbb{E}_{\bm{\epsilon}} \left[ \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i f(X_i) \right| \big| \bm{X} \right] \right] \\
		\leq & \sup_{\bm{x}} \mathbb{E}_{\bm{\epsilon}} \left[ \sup_{f \in \mathscr{F}} \left| \frac{1}{n} \sum_{i=1}^n \epsilon_i f(X_i) \right| \big| \bm{X} = \bm{x} \right]
		\leq 2 \sup_{\bm{x}} \sup_{f \in \mathscr{F}} \sqrt{\frac{1}{n} \sum_{i=1}^n f(x_i)^2} \cdot \sqrt{\frac{\nu \log(n+1)}{n}} \\
		\leq & 2 b \sqrt{\frac{\nu \log(n+1)}{n}}. 
	\end{align*} 
	结合定理\ref{thm:EmpericalMeasureErrorUpperBddByRC}, 我们可以看到具有多项式识别的有界函数类总是Glivenko-Cantelli的. 
	例如, 经典的Glivenko-Cantelli定理考虑的函数类$\mathscr{F} = \{\I{(- \infty, t]} \colon t \in \mathbb{R} \}$是$1$-一致有界的, 我们可以得到Glivenko-Cantelli定理的定量版本. 
\end{remark}

\begin{corollary}[Glivenko-Cantelli定理-定量版本]\label{thm:Glivenko-Cantelli}
	对任意$\delta \geq 0$, 
	\begin{equation*}
		\mathbb{P}\left[ \|\hat F_n - F \|_{\infty} \geq 8 \sqrt{\frac{\log(n+1)}{n}} + \delta \right]
		\leq \exp\left(- \frac{n \delta^2}{2}\right). 
	\end{equation*}
	于是$\|\hat F_n - F \|_{\infty}$以指数速度几乎确定收敛于$0$.   
\end{corollary}
\begin{proof}
	对于任意样本$\bm{x}_1^n$, 考虑次序样本$x_{(1)} \leq x_{(2)} \leq \dots \leq x_{(n)}$, 我们有
	\begin{equation*}
		\mathscr{F}(\bm{x}_1^n) \subseteq \{(0,0, \dots, 0), (1,0, \dots, 0), (1,1, \dots, 0), \dots, (1,1,\dots, 1) \}. 
	\end{equation*}
	于是$\card(\mathscr{F}(\bm{x}_1^n)) \leq n+1$, 即多项式识别阶数$\nu = 1$, 于是$\mathcal{R}_{\mathbb{P}_n}(\mathscr{F}) \leq 2 \sqrt{\frac{\log(n+1)}{n}}$. 
	结合定理\ref{thm:EmpericalMeasureErrorUpperBddByRC}可见不等式成立. 
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Vapnik-Čhervonenkis维数}

对于布尔值函数类, 即值域为$\{0, 1\}$的函数构成的类, 我们常用\textbf{Vapnik-Chervonenkis维数}(简称VC维数)来衡量它的复杂度. 

hypothesis class/ concept class

例如集合类$\mathcal{S}$的示性函数类$\I{\mathcal{S}} := \{\I{S} \colon S \in \mathcal{S} \}$, 为了记号的方便, 我们将集合类$\mathcal{S}$等价于函数类$\I{\mathcal{S}}$. 
 
 


集合$\Lambda$被函数类\textbf{打散}是指无论我们对每个点如何赋予布尔值标签, 都有函数类中的一个函数将它实现. 
例如对于点集$\bm{x}_1^n =\{x_1, \dots, x_n\} \subseteq \cX$, 共有$2^n$种赋予布尔值标签的方式, 换而言之, 集合$\mathscr{F}(\bm{x}_1^n)$至多有$2^n$个元素, 于是$\bm{x}_1^n$被打散等价于$\card(\mathscr{F}(\bm{x}_1^n)) = 2^n$. 
函数类的 VC 维定义为可以被其成员打散的点的最多数目．

\begin{definition}[VC维数]
	我们称集合$\Lambda \subseteq \cX$被$\mathscr{F}$打散, 如果对任意映射$g \colon \Lambda \to \{0, 1\}$, 都存在某个$f \in \mathscr{F}$使得$f|_{\Lambda} = g$.
	函数类$\mathscr{F}$的VC维数为能被$\mathscr{F}$打散的集合的最大基数: 如果
	\begin{equation*}
		\vc(\mathscr{F}) = \max \{\card(\Lambda) \colon \card(\mathscr{F}(\Lambda)) = 2^{\card(\Lambda)} \} < \infty
	\end{equation*}
	则称函数类$\mathscr{F}$为\textbf{VC类}, 否则, 记$\vc(\mathscr{F}) = \infty$. 
\end{definition}

\begin{example}[$\mathbb{R}$上的区间]
	推论\ref{thm:Glivenko-Cantelli}的证明本质上考虑了$\mathbb{R}$上左侧半区间类$\mathcal{S}_{\text{left}} := \{(-\infty, t] \colon t \in \mathbb{R} \}$的示性函数类, 它的多项式识别的阶为$1$. 
	对于$x_1 < x_2$, $\mathcal{S}_{\text{left}}(x_1, x_2) = \{(0,0), (0,1), (1,1)\}$, 于是$\vc(\mathcal{S}_{\text{left}}) = 1$. 
	
	进一步地, 双侧区间类$\mathcal{S}_{\text{two}} :\{(b, a] \colon a, b \in \mathbb{R}, b < a \}$的示性函数类可以打散任意的两点集, 但是对于三个不同的点$x_1 < x_2 < x_3$, 它不能选出集合$\{x_1, x_3\}$: 即$(1,0,1) \notin \mathcal{S}_{\text{two}}(\bm{x}_1^3)$, 于是$\vc(\mathcal{S}_{\text{two}}) = 2$. 
	此外, $\card(\mathcal{S}_{\text{two}}(\bm{x}_1^n)) \leq (n+1)^2$, 于是$\mathcal{S}_{\text{two}}$多项式识别的阶为$2$. 
\end{example}


根据定义, 若$\vc(\mathscr{F}) < n$, 我们只能得到指数增长的结果$\card(\mathscr{F}(\bm{x}_1^n)) \leq 2^n - 1$.
但是在上述示例中, 我们看到VC维数和多项式识别的阶数似乎存在着一定的联系.
事实上, 利用组合的方法, 我们可以得到如下结论. 
\begin{lemma}[Sauer-Shelah]\label{lemma:Sauer-Shelah}
	设$\mathcal{S}$是VC类, 对任意点集$\bm{x}_1^n$, 其中$n > \vc(\mathcal{S})$, 我们有
	\begin{equation*}
		\card(\mathcal{S}(\bm{x}_1^n))
		\leq \sum_{i=1}^{\vc(\mathcal{S})} \binom ni
		\leq (n+1)^{\vc(\mathcal{S})}. 
	\end{equation*}
\end{lemma}
\begin{proof}
	
\end{proof}

VC类在有限次集合运算下保持不变, 这被称为VC稳定性. 
\begin{proposition}[VC稳定性]
	若$\mathcal{S}$和$\mathcal{T}$是VC类, 那么下述集合类也是VC类: 
	\begin{enumerate}[label=(\arabic*)]
		\item $\mathcal{S}^c := \{S^c \colon S \in \mathcal{S}\}$;
		\item $\mathcal{S} \sqcap \mathcal{T} := \{S \cap T \colon S \in \mathcal{S}, T \in \mathcal{T}\}$;
		\item $\mathcal{S} \sqcup \mathcal{T} := \{S \cup T \colon S \in \mathcal{S}, T \in \mathcal{T}\}$.
	\end{enumerate}
\end{proposition}
\begin{proof}
	\begin{enumerate}[label=(\arabic*)]
		\item 若点集$\bm{x}_1^n$可以被$\mathcal{S}$打散, 对任意$S \in \mathcal{S}$, 由于$S^c$会给$\bm{x}_1^n$和$S$完全相反的布尔值标签, 于是$\card(\mathcal{S}^c(\bm{x}_1^n)) = 2^n = \card(\mathcal{S}(\bm{x}_1^n))$, 即$\vc(\mathcal{S}^c) = \vc(\mathcal{S})$. 
		\item 注意到对任意的$S \in \mathcal{S}, T \in \mathcal{T}$, 我们有$\I{S \cap T} = \I{S} \cdot \I{T}$, 结合引理\ref{lemma:Sauer-Shelah}, 
			\begin{equation*}
				\card\left( \mathcal{S} \sqcap \mathcal{T} (\bm{x}_1^n) \right) 
				\leq \card(\mathcal{S}(\bm{x}_1^n)) \cdot \card(\mathcal{T}(\bm{x}_1^n))
				\leq (n+1)^{\vc(\mathcal{S}) + \vc(\mathcal{T})}. 
			\end{equation*}
		\item 由$S \cup T = (S^c \cap T^c)^c$可见成立. 
	\end{enumerate}
\end{proof}


实值函数类$\mathscr{F}$可以通过取$0$-下水平集来定义\textbf{相伴集合类}$\mathcal{S}(\mathscr{F}):=\{S_f \colon f \in \mathscr{F}\}$, 其中$S_f := \{x \in \cX \colon f(x) \leq 0\}$称为函数$f$的$0$-下水平集. 
很多重要的集合类, 例如半平面、椭球体, 都可以用这种方式来表达. 

\begin{proposition}
	设函数类$\mathscr{G}$为$\mathbb{R}^d$上实值函数的线性空间, 其中$\dim(\mathscr{G}) < \infty$, 那么$\mathcal{S}(\mathscr{G})$的VC维数至多为$\dim(\mathscr{G})$. 	
\end{proposition}
\begin{proof}
	采用反证法, 假设存在点集$\bm{x}_1^n = \{x_1, \dots, x_n\} \subseteq \mathbb{R}^d$可以被$\mathcal{S}(\mathscr{G})$打散, 其中$n = \dim(\mathscr{G}) + 1$.
	由于$\mathscr{G}$构成了线性空间, 集合$\mathscr{G}(\bm{x}_1^n) = \{(g(x_1), \dots, g(x_n)) \colon g \in \mathscr{G}\}$构成了$\mathbb{R}^n$的子空间, 并且它的维数至多为$\dim(\mathscr{G}) = n-1 < n$. 
	因此, 存在某个非零向量$\bm\gamma \in \mathbb{R}^n$满足$\langle \bm{\gamma}, g(\bm{x}_1^n) \rangle = \sum_i \gamma_i g(x_i) = 0$, $\forall g \in \mathscr{G}$. 
	不失一般性地, 假定$\bm{\gamma}$至少存在一个正的分量, 于是
	\begin{equation*}
		\sum_{i \colon \gamma_i \leq 0} (-\gamma_i) g(x_i)
		= \sum_{i \colon \gamma_i > 0} \gamma_i g(x_i), \quad
		\forall g \in \mathscr{G}. 
	\end{equation*}
	由于$\mathcal{S}(\mathscr{G})$可以将$\bm{x}_1^n$打散, 于是存在$g \in \mathscr{G}$使得$S_g \cap \bm{x}_1^n = \{x_i \colon \gamma_i \leq 0\}$, 此时等式右侧严格正而左侧非正, 推出矛盾. 
\end{proof}

\begin{example}[$\mathbb{R}^d$中的半平面]
	$\mathbb{R}^n$中的半平面$H_{\bm{a},b} := \{\bm{x} \in \mathbb{R}^d \colon \langle \bm{a}, \bm{x} \rangle  \leq b\}$可以看作线性函数$l_{\bm{a},b}(\bm{x}) = \langle \bm{a}, \bm{x} \rangle - b$的$0$-下水平集. 
	全体线性函数构成类$\sL^d := \{l_{\bm{a},b} \colon (\bm{a}, b) \in \mathbb{R}^d \times \mathbb{R} \}$, 由线性代数的知识, 不难看出它是$d+1$维的线性空间, 于是$\mathcal{S}(\sL^d)$的VC维数不会大于$d+1$. 
\end{example}


\begin{example}[$\mathbb{R}^d$中的球]
	考虑$\mathbb{R}^d$中全体的欧氏球$\mathcal{S}^d_{\text{euc}} := \{S_{\bm{a},b} \colon (\bm{a},b) \in \mathbb{R}^d \times \mathbb{R}_{+}\}$, 其中$S_{\bm{a},b} := \{\bm{x} \in \mathbb{R}^d \colon \|\bm{x} - \bm{a}\|_2 \leq b\}$为以$\bm{a}$为圆心、$b$为半径的欧氏球, 可以看作是$s_{\bm{a},b} := \|\bm{x} - \bm{a}\|_2 - b$的$0$-下水平集. 
	考虑特征映射$\phi \colon \mathbb{R}^d \to \mathbb{R}^{d+2}$, $\bm{x} \mapsto \left(1, x_1, \dots, x_n, \|\bm{x}\|_2^2 \right)$, 函数$g_{\bm{c}}(\bm{x}) := \langle\bm{c}, \bm{x}\rangle$构成的函数类$\mathscr{G} = \{g_{\bm{c}} \colon \bm{c} \in \mathbb{R}^{d+2}$是一个$d+2$维的线性空间, 并且$s_{\bm{a},b}$就属于此类. 
	于是$\vc(\mathcal{S}^d_{\text{euc}}) \leq d+2$. \footnote{一个更加细致的分析可以得到它的VC维数实际上是$d+1$.}
\end{example}


8.3.5 Empirical processes via VC dimension (HDP)


\begin{theorem}[VC类的一致大数定律]
	设$\sF$为VC类, 
	\begin{equation*}
		\E\left[ \|\P_n - \P\|_{\sF} \right] \leq C \sqrt{\frac{\vc(\sF)}{n}}. 
	\end{equation*}
\end{theorem}









